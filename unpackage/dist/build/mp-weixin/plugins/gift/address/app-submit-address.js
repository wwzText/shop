(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["plugins/gift/address/app-submit-address"],{"5ede":function(t,e,i){"use strict";var r;i.d(e,"b",(function(){return o})),i.d(e,"c",(function(){return s})),i.d(e,"a",(function(){return r}));var o=function(){var t=this,e=t.$createElement,i=(t._self._c,"offline"===t.delivery?Object.keys(t.store):null),r="offline"===t.delivery?Object.keys(t.store):null,o="offline"===t.delivery?Object.keys(t.store):null;t.$mp.data=Object.assign({},{$root:{g0:i,g1:r,g2:o}})},s=[]},a06d:function(t,e,i){"use strict";var r=i("bd6c5"),o=i.n(r);o.a},bd6c5:function(t,e,i){},d810:function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=i("2f62");function o(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,r)}return i}function s(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?o(Object(i),!0).forEach((function(e){n(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):o(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function n(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var a=function(){i.e("components/basic-component/app-iphone-x/app-iphone-x").then(function(){return resolve(i("5e0d"))}.bind(null,i)).catch(i.oe)},d={props:["theme","address","goods_id","user_order_id","store_list","store_index","send_type","goods","remark","mch","dis_send_type","diyForm","store","template_message_captain"],data:function(){return{delivery:"express",name:"",mobile:"",send_text:"",hasCity:!1}},methods:{jump:function(){t.navigateTo({url:"/pages/order-submit/map"})},navigateAddress:function(){var e="/pages/order-submit/address-pick";e+="?sign=gift&id="+this.user_order_id+"&hasCity="+this.hasCity,t.navigateTo({url:e})},setMethod:function(t){this.delivery=t,this.send_text=t,this.hasCity=!1,this.$emit("delivery",t),"offline"===this.delivery?this.$emit("setMethod"):"city"===this.delivery?(this.hasCity=!0,this.$emit("city")):"express"===this.delivery&&this.$emit("express")},submit:function(){var t=this;this.$subscribe(this.template_message_captain).then((function(){t.submission()})).catch((function(){t.submission()}))},submission:function(){var e=this;for(var i in this.goods){var r=this.goods[i];if(r.goods_form_validate_result&&r.goods_form_validate_result.hasError)return void t.showModal({title:"提示",content:r.goods_form_validate_result.errors[0].msg,showCancel:!1})}t.showLoading({title:"提交中"});for(var o={list:[{mch_id:0,goods_list:[],send_type:this.send_text,store_id:this.store.id,use_integral:0,user_coupon_id:0,remark:this.remark,order_form:this.diyForm}],address_id:this.address&&this.address.id?this.address.id:0,address:{name:this.name,mobile:this.mobile}},s=0;s<this.goods.length;s++){for(var n={id:this.goods[s].goods_id,attr:[],num:this.goods[s].num,cat_id:0,goods_attr_id:this.goods[s].goods_attr_id,cart_id:0,user_order_id:this.user_order_id,form_data:this.goods[s].form_data},a=[],d=this.goods[s].goods_info,u=0;u<d.length;u++)a.push({attr_id:d[u].attr_id,attr_group_id:d[u].attr_group_id});n.attr=a,o.list[0].goods_list.push(n)}this.$request({url:this.$api.gift.convert,method:"post",data:{form_data:JSON.stringify(o)}}).then((function(i){0===i.code?e.pay_data(i.data):(t.hideLoading(),t.showModal({title:"提示",content:i.msg}))}))},route_go:function(){t.navigateTo({url:"/pages/order-submit/store-pick?plugin=gift"})},pay_data:function(e){var i=this;this.$request({url:this.$api.order.pay_data,method:"post",data:s({},e)}).then((function(r){if(0===r.code)if(r.data.hasOwnProperty("id")){var o=r.data.id;0==i.mch.express_price?i.$request({url:i.$api.payment.get_payments,method:"get",data:{id:o}}).then((function(e){0===e.code?i.$request({url:i.$api.payment.pay_data,method:"get",data:{id:o,pay_type:"balance"}}).then((function(e){0===e.code?i.$request({url:i.$api.payment.pay_buy_balance,data:{id:o}}).then((function(e){0===e.code?(t.hideLoading(),t.redirectTo({url:"/pages/order-submit/pay-result?payment_order_union_id=".concat(o,"&order_page_url=").concat(encodeURIComponent("/plugins/gift/order/order"))})):(t.hideLoading(),t.showModal({title:"提示",content:e.msg}))})):(t.hideLoading(),t.showModal({title:"提示",content:e.msg}))})):(t.hideLoading(),t.showModal({title:"提示",content:e.msg}))})):i.$payment.pay(o).then((function(e){t.hideLoading(),t.redirectTo({url:"/plugins/gift/order/order"})})).catch((function(e){t.hideLoading(),t.redirectTo({url:"/plugins/gift/order/order"})}))}else setTimeout((function(){i.pay_data(e)}),1e3);else t.hideLoading(),t.showModal({title:"提示",content:r.msg})}))}},computed:s({},(0,r.mapState)({appImg:function(t){return t.mallConfig.__wxapp_img}})),watch:{send_type:{handler:function(t){if(0!==t.length)for(var e=0;e<t.length;e++)this.dis_send_type===t[0].value&&(this.delivery=t[0].value,this.send_text=t[0].value,"city"===t[0].value&&(this.hasCity=!0))},immediate:!0}},components:{"app-iphone-x":a}};e.default=d}).call(this,i("543d")["default"])},e403:function(t,e,i){"use strict";i.r(e);var r=i("5ede"),o=i("f497");for(var s in o)"default"!==s&&function(t){i.d(e,t,(function(){return o[t]}))}(s);i("a06d");var n,a=i("f0c5"),d=Object(a["a"])(o["default"],r["b"],r["c"],!1,null,"4b3eacbc",null,!1,r["a"],n);e["default"]=d.exports},f497:function(t,e,i){"use strict";i.r(e);var r=i("d810"),o=i.n(r);for(var s in r)"default"!==s&&function(t){i.d(e,t,(function(){return r[t]}))}(s);e["default"]=o.a}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'plugins/gift/address/app-submit-address-create-component',
    {
        'plugins/gift/address/app-submit-address-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('543d')['createComponent'](__webpack_require__("e403"))
        })
    },
    [['plugins/gift/address/app-submit-address-create-component']]
]);
