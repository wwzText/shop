(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["plugins/pt/goods/goods"],{5608:function(t,e,n){"use strict";var i=n("8522"),o=n.n(i);o.a},"5f27":function(t,e,n){"use strict";(function(t){n("b8bc");i(n("66fd"));var e=i(n("e566"));function i(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("543d")["createPage"])},8522:function(t,e,n){},"89b4":function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r(n("a34a")),o=n("2f62");function r(t){return t&&t.__esModule?t:{default:t}}function s(t,e,n,i,o,r,s){try{var a=t[r](s),c=a.value}catch(u){return void n(u)}a.done?e(c):Promise.resolve(c).then(i,o)}function a(t){return function(){var e=this,n=arguments;return new Promise((function(i,o){var r=t.apply(e,n);function a(t){s(r,i,o,a,c,"next",t)}function c(t){s(r,i,o,a,c,"throw",t)}a(void 0)}))}}function c(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function u(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?c(Object(n),!0).forEach((function(e){p(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function p(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var l=function(){n.e("components/page-component/goods/app-goods-banner").then(function(){return resolve(n("b169"))}.bind(null,n)).catch(n.oe)},d=function(){n.e("plugins/pt/components/app-pt-time").then(function(){return resolve(n("1e9a"))}.bind(null,n)).catch(n.oe)},h=function(){n.e("plugins/pt/components/app-merchant-guarantee").then(function(){return resolve(n("6e05"))}.bind(null,n)).catch(n.oe)},g=function(){n.e("plugins/pt/components/app-buttom-button").then(function(){return resolve(n("186d"))}.bind(null,n)).catch(n.oe)},f=function(){n.e("plugins/pt/components/app-pt-attr").then(function(){return resolve(n("bff5"))}.bind(null,n)).catch(n.oe)},m=function(){n.e("plugins/pt/components/app-participant").then(function(){return resolve(n("1b29"))}.bind(null,n)).catch(n.oe)},_=function(){n.e("components/page-component/app-related-suggestion-product/app-related-suggestion-product").then(function(){return resolve(n("3d12"))}.bind(null,n)).catch(n.oe)},b=function(){n.e("components/page-component/app-quick-navigation/app-quick-navigation").then(function(){return resolve(n("36d8"))}.bind(null,n)).catch(n.oe)},v=function(){n.e("components/page-component/goods/app-goods-full-reduce").then(function(){return resolve(n("2069"))}.bind(null,n)).catch(n.oe)},w=function(){n.e("components/page-component/goods/u-attr").then(function(){return resolve(n("fae7"))}.bind(null,n)).catch(n.oe)},A=function(){n.e("components/page-component/goods/bd-info").then(function(){return resolve(n("3a59"))}.bind(null,n)).catch(n.oe)},$=function(){Promise.all([n.e("common/vendor"),n.e("components/page-component/goods/bd-coupon")]).then(function(){return resolve(n("cfa2"))}.bind(null,n)).catch(n.oe)},T=function(){n.e("components/page-component/goods/bd-xbc").then(function(){return resolve(n("abb7"))}.bind(null,n)).catch(n.oe)},y=function(){n.e("components/page-component/goods/bd-kb").then(function(){return resolve(n("7e79"))}.bind(null,n)).catch(n.oe)},O=function(){n.e("components/page-component/goods/bd-hc").then(function(){return resolve(n("ecb3"))}.bind(null,n)).catch(n.oe)},I=function(){n.e("components/page-component/goods/bd-detail").then(function(){return resolve(n("c91c"))}.bind(null,n)).catch(n.oe)},k=function(){n.e("components/page-component/goods/bd-comments").then(function(){return resolve(n("57fa"))}.bind(null,n)).catch(n.oe)},P=function(){n.e("components/basic-component/app-close/app-close").then(function(){return resolve(n("699f"))}.bind(null,n)).catch(n.oe)},G={name:"goods",data:function(){return{showClose:!1,is_open:0,goods_id:0,detail:{goods_activity:{full_reduce:{}},groups:[]},full_reduce:null,loading:!1,share_url:"",time_str:{day:"00",hou:"00",min:"00",sec:"00"},down_time:0,discount:null,isVip:!1,goods:{},item:{name:"",pintuan_groups:[]},selectAttr:null,show:!1,pt:!1,selectGroupAttrId:0,pintuan_list:[],list:[],cartShow:!1,price:"",time:null,is_vip_card_user:0,url:this.$api.pt.detail,poster_config:this.$api.pt.poster_config,poster_generate:this.$api.pt.poster_generate,aloneAttr:null,start_time:!1,pintuan_list_time:"",pt_time:null,number:1,group_price:"",again:0,flash_sale:null}},computed:u(u(u(u({},(0,o.mapState)("gConfig",{iphone:function(t){return t.iphone},iphoneHeight:function(t){return t.iphoneHeight}})),(0,o.mapState)({mall:function(t){return t.mallConfig.mall}})),(0,o.mapGetters)("mallConfig",{getTheme:"getTheme"})),{},{themeObject:function(){return{back:this.getTheme+"-m-back "+this.getTheme,theme:this.getTheme,color:this.getTheme+"-m-text "+this.getTheme,sBack:this.getTheme+"-s-back "+this.getTheme,backP:this.getTheme+"-m-back-p "+this.getTheme}},set_group_num:function(){for(var t=0;t<this.detail.groups.length;t++)if(this.detail.groups[t].groups.id==this.selectGroupAttrId)return t},groupPrice:function(){if(!this.$validation.isEmpty(this.selectAttr)){if(this.pt)return 1===this.detail.level_show?0===this.selectAttr.price_member?"免费":"￥".concat(this.selectAttr.price_member):0===Number(this.selectAttr.price)?"免费":"￥".concat(this.selectAttr.price);for(var t=this.detail.groups[this.set_group_num].attr,e=0;e<t.length;e++)if(t[e].sign_id===this.selectAttr.sign_id)return 1===this.detail.level_show?0===t[e].price_member?"免费":"￥".concat(t[e].price_member):0===Number(t[e].price)?"免费":"￥".concat(t[e].price)}},singlePrice:function(){if(!this.$validation.isEmpty(this.selectAttr))for(var t=0;t<this.aloneAttr.length;t++)if(this.aloneAttr[t].sign_id===this.selectAttr.sign_id)return 1===this.detail.level_show?0===Number(this.aloneAttr[t].price_member)?"免费":"￥".concat(this.aloneAttr[t].price_member):0===Number(this.aloneAttr[t].price)?"免费":"￥".concat(this.aloneAttr[t].price)},groupSparePrice:function(){return this.detail.groups.length>0?(this.detail.original_price-this.detail.groups[0].price_min).toFixed(2):this.detail.original_price}}),onShow:function(){var t=this;this.showClose=!1,setTimeout((function(){t.showClose=!0}))},onLoad:function(t){this.goods_id=t.goods_id,this.requestDetail(),this.newRecommend(),wx.showShareMenu({menus:["shareAppMessage","shareTimeline"]})},onShareAppMessage:function(){return this.$shareAppMessage({path:"/plugins/pt/goods/goods",title:this.detail.app_share_title?this.detail.app_share_title:this.detail.name,imageUrl:this.detail.app_share_pic?this.detail.app_share_pic:"",params:{goods_id:this.goods_id}})},onShareTimeline:function(){return this.$shareTimeline({title:this.detail.app_share_title?this.detail.app_share_title:this.detail.name,query:{goods_id:this.goods_id}})},methods:{getMall:function(t){this.is_open=t.is_open},goJoin:function(e){t.navigateTo({url:"/plugins/pt/detail/detail?id=".concat(e)})},requestDetail:function(){var e=this;return a(i.default.mark((function n(){var o,r,s,a,c,u,p;return i.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.$request({url:e.$api.pt.detail,method:"get",data:{id:e.goods_id}});case 2:o=n.sent,0===o.code?(e.loading=!0,r=o.data.detail,e.detail=r,e.price=r.price,e.aloneAttr=JSON.parse(JSON.stringify(r.attr)),s=r.groups,s.length>0&&(e.detail.attr=s[0].attr,e.selectGroupAttrId=s[0].groups.id),r.goods_activity&&(e.full_reduce=r.goods_activity.full_reduce),e.flash_sale=r.plugin_extra.flash_sale,e.share_url="".concat(e.$api.pt.poster,"&goods_id=").concat(e.detail.id),e.poster_config="".concat(e.poster_config,"&goods_id=").concat(e.detail.id),e.poster_generate="".concat(e.poster_generate,"&goods_id=").concat(e.detail.id),e.pintuan_list=o.data.pintuan_list,e.pintuan_list.length>0&&(a=new Date(e.pintuan_list[0].surplus_date_time.replace(/-/g,"/")),e.pt_time=setInterval((function(){var t=a.getTime()-(new Date).getTime();t<0&&clearInterval(e.pt_time);var n=parseInt(t/1e3/60/60/24%30),i=parseInt(t/1e3/60/60%24),o=parseInt(t/1e3/60%60),r=parseInt(t/1e3%60);e.pintuan_list_time=n>0?n+"天"+i+":"+(o<10?"0"+o:o)+":"+(r<10?"0"+r:r):i+":"+(o<10?"0"+o:o)+":"+(r<10?"0"+r:r)}),1e3)),r.vip_card_appoint.discount&&(e.isVip=!0,e.discount=r.vip_card_appoint.discount),e.is_vip_card_user=r.vip_card_appoint.is_vip_card_user,e.goods={attr:r.attr,cover_pic:r.cover_pic,level_show:r.level_show,price:r.price,mch_id:r.mch_id},"0000-00-00 00:00:00"!==r.pintuanGoods.end_time&&e.countdown(r.pintuanGoods.end_time),r.pintuanGoods.start_time&&(c=new Date(r.pintuanGoods.start_time.replace(/-/g,"/")),u=new Date,p=c.getTime()-u.getTime(),p>0?(e.start_time=!1,e.countdown(r.pintuanGoods.start_time)):e.start_time=!0)):t.showToast({title:o.msg,icon:"none"});case 4:case"end":return n.stop()}}),n)})))()},countdown:function(t){var e=this,n=new Date(t.replace(/-/g,"/")),i=new Date,o=n.getTime()-i.getTime(),r=parseInt(o/36e5/24),s=parseInt(o/1e3/60/60%24),a=parseInt(o/1e3/60%60),c=parseInt(o/1e3%60);this.time_str={day:r<10?"0".concat(r):r,hou:s<10?"0".concat(s):s,min:a<10?"0".concat(a):a,sec:c<10?"0".concat(c):c},this.down_time=setTimeout((function(){e.countdown(t)}),1e3)},newRecommend:function(){var t=this;return a(i.default.mark((function e(){var n;return i.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$request({url:t.$api.goods.new_recommend});case 2:n=e.sent,0===n.code&&(t.list=n.data.list);case 4:case"end":return e.stop()}}),e)})))()},setCoupon:function(t){this.$set(this.detail.goods_coupon_center[t],"is_receive",1)},attrTap:function(t,e){for(var n=0;n<this.aloneAttr.length;n++)this.aloneAttr[n].sign_id===t.sign_id&&(this.price=this.aloneAttr[n].price);this.number=e,this.selectAttr=t},shop:function(t){var e=this;!0===t?(this.$set(this,"pt",!0),this.detail.groups.forEach((function(t){e.selectGroupAttrId===t.groups.id&&(e.$set(e.detail,"attr",t.attr),e.$set(e.detail,"id",t.groups.goods_id))}))):(this.$set(this,"pt",!1),this.$set(this.detail,"attr",this.aloneAttr),this.$set(this.detail,"id",this.goods_id)),this.show=!0},setGroupAttrID:function(t){var e=this;this.selectGroupAttrId=t.groups.id,this.$set(this.detail,"attr",t.attr),this.$set(this.detail,"id",t.groups.goods_id),this.$nextTick((function(){e.again=Math.random()}))},defaultRequest:function(){this.$set(this,"pt",!0),this.detail.attr=this.detail.groups[0].attr,this.selectGroupAttrId=this.detail.groups[0].groups.id,this.detail.id=this.detail.groups[0].groups.goods_id},rightFunc:function(){var e=this;if(!1===this.pt&&!0===this.show)this.pt=!0,this.$set(this,"pt",!0),setTimeout((function(){e.show=!0}),500),this.detail.groups.forEach((function(t){e.selectGroupAttrId===t.groups.id&&(e.$set(e.detail,"attr",t.attr),e.$set(e.detail,"id",t.groups.goods_id))})),this.$nextTick((function(){e.again=Math.random()}));else{var n=[];this.selectAttr.attr_list.forEach((function(t){n.push({attr_id:t.attr_id,attr_group_id:t.attr_group_id})}));var i={pintuan_order_id:0,pintuan_group_id:this.selectGroupAttrId,mch_id:this.detail.mch_id?this.detail.mch_id:0,goods_list:[{id:this.detail.id,attrs:n,num:this.number,cat_id:0,goods_attr_id:this.selectAttr.id}]};t.navigateTo({url:"/pages/order-submit/order-submit?mch_list=".concat(JSON.stringify([i]),"&preview_url=").concat(encodeURIComponent(this.$api.pt.order_preview),"&submit_url=").concat(encodeURIComponent(this.$api.pt.order_submit))})}},leftFunc:function(e){var n=this;if(!0===this.pt&&!0===this.show)this.$set(this,"pt",!1),setTimeout((function(){n.show=!0}),500),this.$set(this.detail,"attr",this.aloneAttr),this.$set(this.detail,"id",this.goods_id),this.$nextTick((function(){n.$refs.attr.firstSelect()}));else{var i=this.detail,o=this.selectAttr,r=[];for(var s in o.attr_list)r.push({attr_id:o.attr_list[s].attr_id,attr_group_id:o.attr_list[s].attr_group_id});var a=[{mch_id:i.mch_id?i.mch_id:0,pintuan_order_id:0,pintuan_group_id:0,goods_list:[{id:i.id,attr:r,num:e,cat_id:0,goods_attr_id:o.id}]}];t.navigateTo({url:"/pages/order-submit/order-submit?mch_list=".concat(JSON.stringify(a),"&preview_url=").concat(encodeURIComponent(this.$api.pt.order_preview),"&submit_url=").concat(encodeURIComponent(this.$api.pt.order_submit))})}}},components:{bdInfo:A,bdCoupon:$,bdXbc:T,bdKb:y,bdHc:O,bdDetail:I,bdComments:k,"app-goods-banner":l,"app-pt-time":d,"app-merchant-guarantee":h,"app-button-button":g,"app-pt-attr":f,"app-participant":m,"app-related-suggestion-product":_,"app-quick-navigation":b,uAttr:w,appGoodsFullReduce:v,appClose:P},onHide:function(){clearTimeout(this.down_time)},onUnload:function(){clearTimeout(this.down_time)}};e.default=G}).call(this,n("543d")["default"])},b233:function(t,e,n){"use strict";var i;n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return r})),n.d(e,"a",(function(){return i}));var o=function(){var t=this,e=t.$createElement;t._self._c},r=[]},d420:function(t,e,n){"use strict";n.r(e);var i=n("89b4"),o=n.n(i);for(var r in i)"default"!==r&&function(t){n.d(e,t,(function(){return i[t]}))}(r);e["default"]=o.a},e566:function(t,e,n){"use strict";n.r(e);var i=n("b233"),o=n("d420");for(var r in o)"default"!==r&&function(t){n.d(e,t,(function(){return o[t]}))}(r);n("5608");var s,a=n("f0c5"),c=Object(a["a"])(o["default"],i["b"],i["c"],!1,null,"0796271a",null,!1,i["a"],s);e["default"]=c.exports}},[["5f27","common/runtime","common/vendor"]]]);