(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["plugins/miaosha/advance/advance"],{"0e21":function(e,t,n){"use strict";var i=n("9759"),r=n.n(i);r.a},2315:function(e,t,n){"use strict";var i;n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return i}));var r=function(){var e=this,t=e.$createElement;e._self._c},a=[]},3932:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(n("a34a")),r=n("2f62");function a(e){return e&&e.__esModule?e:{default:e}}function o(e){return l(e)||u(e)||c(e)||s()}function s(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(e,t){if(e){if("string"===typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(e,t):void 0}}function u(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function l(e){if(Array.isArray(e))return p(e)}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function m(e,t,n,i,r,a,o){try{var s=e[a](o),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(i,r)}function h(e){return function(){var t=this,n=arguments;return new Promise((function(i,r){var a=e.apply(t,n);function o(e){m(a,i,r,o,s,"next",e)}function s(e){m(a,i,r,o,s,"throw",e)}o(void 0)}))}}function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){g(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var v=function(){n.e("plugins/miaosha/components/app-product-list").then(function(){return resolve(n("6182"))}.bind(null,n)).catch(n.oe)},_={name:"advance",data:function(){return{time_list:[],goods_list:[],next_time:"",page:1,active_index:null,scroll_id:"",is_estimate:0,open_time:0,type:0,page_count:1,nav_bool:!1,currentRoute:this.$platDiff.route(),time:-1,html:"",is_booking:!1,loading:!1}},computed:d(d(d(d({},(0,r.mapState)({tabBarNavs:function(e){return e.mallConfig.navbar.navs}})),(0,r.mapGetters)("iPhoneX",{BotHeight:"getBotHeight"})),(0,r.mapGetters)("mallConfig",{getTheme:"getTheme"})),{},{themeObject:function(){return{back:this.getTheme+"-m-back "+this.getTheme,backP:this.getTheme+"-m-back-p "+this.getTheme,backO:this.getTheme+"-m-back-o "+this.getTheme,theme:this.getTheme,color:this.getTheme+"-m-text "+this.getTheme,sBack:this.getTheme+"-s-back "+this.getTheme,border:this.getTheme+"-m-border "+this.getTheme}}}),onLoad:function(){var e=this;this.getTimeList().then((function(){var t=!1;e.time_list.map((function(n,i){1===n.status&&(t=!0,e.active_index=i,e.scroll_id="ms_".concat(i),n.type=1,e.getGoodsList(n))})),e.$nextTick((function(){e.loading=!0})),!1===t&&(e.active_index=0,e.time_list.length>0?(e.type=1,e.open_time=e.time_list[0].open_time,e.getGoodsList({open_time:e.open_time,type:e.type})):1===e.is_estimate&&(e.type=2,e.open_time=0,e.is_booking=!0,e.getGoodsList({open_time:e.open_time,type:e.type})))})),wx.showShareMenu({menus:["shareAppMessage","shareTimeline"]})},onShow:function(){1===this.type&&this.set_time(this.time_list[this.active_index].date_time)},onHide:function(){clearInterval(this.time)},onUnload:function(){clearInterval(this.time)},methods:{getTimeList:function(){var t=this;return h(i.default.mark((function n(){var r,a,o,s,c;return i.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return e.showLoading({title:"加载中..."}),n.prev=1,n.next=4,t.$request({url:t.$api.miaosha.time_list,method:"get"});case 4:r=n.sent,0===r.code&&(a=r.data,o=a.is_estimate,s=a.list,c=a.next_miaosha_date_time,t.time_list=s,t.is_estimate=o,t.next_time=c),n.next=11;break;case 8:throw n.prev=8,n.t0=n["catch"](1),new Error(n.t0);case 11:e.hideLoading();case 12:case"end":return n.stop()}}),n,null,[[1,8]])})))()},getGoodsList:function(e){var t=this;return h(i.default.mark((function n(){var r;return i.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,t.open_time=e.open_time,t.type=e.type,1===t.type?t.set_time(e.date_time):clearInterval(t.time),n.next=6,t.$request({url:t.$api.miaosha.goods,data:{open_time:e.open_time,type:e.type,page:t.page}});case 6:r=n.sent,0===r.code&&(t.goods_list=r.data.list,t.page_count=r.data.pagination.page_count),n.next=13;break;case 10:throw n.prev=10,n.t0=n["catch"](0),new Error(n.t0);case 13:case"end":return n.stop()}}),n,null,[[0,10]])})))()},activeTime:function(e,t){this.active_index=t,this.scroll_id="ms_".concat(t),this.page=1,this.getGoodsList(e),this.getTimeList(),2===e.type?this.is_booking=!0:this.is_booking=!1},scrollLower:function(){var e=this;return h(i.default.mark((function t(){var n;return i.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,!(e.page>=e.page_count)){t.next=3;break}return t.abrupt("return");case 3:return e.page++,t.next=6,e.$request({url:e.$api.miaosha.goods,data:{open_time:e.open_time,type:e.type,page:e.page}});case 6:n=t.sent,0===n.code&&(e.goods_list=[].concat(o(e.goods_list),o(n.data.list))),t.next=13;break;case 10:throw t.prev=10,t.t0=t["catch"](0),new Error(t.t0);case 13:case"end":return t.stop()}}),t,null,[[0,10]])})))()},set_nav:function(){for(var e=this.currentRoute,t=0;t<this.tabBarNavs.length;t++)if(e.includes(this.tabBarNavs[t].url.split("?")[0]))return this.nav_bool=!0;return this.nav_bool=!1},set_time:function(e){var t=this;if(clearInterval(this.time),e){var n=new Date(e.replace(/-/g,"/")),i=n.getTime()-(new Date).getTime(),r=parseInt(i/1e3/60/60/24%30),a=parseInt(i/1e3/60/60%24),o=parseInt(i/1e3/60%60),s=parseInt(i/1e3%60);this.html=r>0?r+"天"+a+":"+(o<10?"0"+o:o)+":"+(s<10?"0"+s:s):a+":"+(o<10?"0"+o:o)+":"+(s<10?"0"+s:s),this.time=setInterval((function(){var e=n.getTime()-(new Date).getTime();e<0&&(clearInterval(t.time),t.time_list[t.active_index].status=2);var i=parseInt(e/1e3/60/60/24%30),r=parseInt(e/1e3/60/60%24),a=parseInt(e/1e3/60%60),o=parseInt(e/1e3%60);t.html=i>0?i+"天"+r+":"+(a<10?"0"+a:a)+":"+(o<10?"0"+o:o):r+":"+(a<10?"0"+a:a)+":"+(o<10?"0"+o:o)}),1e3)}},router_go:function(){e.reLaunch({url:"/pages/index/index"})}},onShareAppMessage:function(){},onShareTimeline:function(){return this.$shareTimeline({title:this.$children[0].navigationBarTitle,query:{}})},components:{"product-list":v},watch:{tabBarNavs:{handler:function(){this.set_nav()},immediate:!0}}};t.default=_}).call(this,n("543d")["default"])},"4a8f":function(e,t,n){"use strict";n.r(t);var i=n("3932"),r=n.n(i);for(var a in i)"default"!==a&&function(e){n.d(t,e,(function(){return i[e]}))}(a);t["default"]=r.a},5098:function(e,t,n){"use strict";(function(e){n("b8bc");i(n("66fd"));var t=i(n("ee92"));function i(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,n("543d")["createPage"])},9759:function(e,t,n){},ee92:function(e,t,n){"use strict";n.r(t);var i=n("2315"),r=n("4a8f");for(var a in r)"default"!==a&&function(e){n.d(t,e,(function(){return r[e]}))}(a);n("0e21");var o,s=n("f0c5"),c=Object(s["a"])(r["default"],i["b"],i["c"],!1,null,"0586902c",null,!1,i["a"],o);t["default"]=c.exports}},[["5098","common/runtime","common/vendor"]]]);