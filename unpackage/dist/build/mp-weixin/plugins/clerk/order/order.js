(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["plugins/clerk/order/order"],{"166f":function(t,e,a){"use strict";var i=a("cdca"),r=a.n(i);r.a},"34d3":function(t,e,a){"use strict";var i;a.d(e,"b",(function(){return r})),a.d(e,"c",(function(){return n})),a.d(e,"a",(function(){return i}));var r=function(){var t=this,e=t.$createElement;t._self._c},n=[]},"522f":function(t,e,a){"use strict";a.r(e);var i=a("34d3"),r=a("a41c");for(var n in r)"default"!==n&&function(t){a.d(e,t,(function(){return r[t]}))}(n);a("166f");var s,o=a("f0c5"),c=Object(o["a"])(r["default"],i["b"],i["c"],!1,null,"49fd3e91",null,!1,i["a"],s);e["default"]=c.exports},a41c:function(t,e,a){"use strict";a.r(e);var i=a("d1a8"),r=a.n(i);for(var n in i)"default"!==n&&function(t){a.d(e,t,(function(){return i[t]}))}(n);e["default"]=r.a},bbf4:function(t,e,a){"use strict";(function(t){a("b8bc");i(a("66fd"));var e=i(a("522f"));function i(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,a("543d")["createPage"])},cdca:function(t,e,a){},d1a8:function(t,e,a){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=a("2f62");function r(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}function n(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?r(Object(a),!0).forEach((function(e){s(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function s(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var o=function(){a.e("components/basic-component/app-tab-nav/app-tab-nav").then(function(){return resolve(a("cf4b"))}.bind(null,a)).catch(a.oe)},c={name:"about",components:{"app-tab-nav":o},data:function(){return{activeTab:2,order_list:[{id:2,name:"未核销"},{id:1,name:"已核销"},{id:5,name:"已退款"},{id:3,name:"我的"}],card_list:[{id:2,name:"未核销"},{id:1,name:"已核销"},{id:3,name:"我的"}],tabList:[],candidate:[],status:1,placeHeight:312,setTop:190,more_list:!1,is_mall:!1,toSearch:!1,searchResult:!1,first:!1,keyword:"",list:[]}},computed:n({},(0,i.mapState)({clerkImg:function(t){return t.mallConfig.__wxapp_img.clerk},mall:function(t){return t.mallConfig.mall}})),onLoad:function(e){var a=this;this.status=e.status,e.type>0&&(this.activeTab=e.type),this.$showLoading({type:"global",text:"加载中..."}),this.$request({url:this.$api.clerk.info}).then((function(e){0==e.code?(a.is_mall=e.data.is_mall,e.data.is_mall||(a.placeHeight=210,a.setTop=88),a.list=[],1==a.status?(a.tabList=a.order_list,a.getList(),t.setNavigationBarTitle({title:"订单"})):2==a.status&&(a.tabList=a.card_list,a.getCard(),t.setNavigationBarTitle({title:"卡券"}))):t.redirectTo({url:"/pages/user-center/user-center"})}))},onReachBottom:function(){this.more_list&&this.getMore()},onShow:function(e){var a=this,i=this;i.first&&i.$request({url:i.$api.clerk.info}).then((function(e){0==e.code?(i.is_mall=e.data.is_mall,e.data.is_mall||(a.placeHeight=112),1==i.status?(i.getList(),t.setNavigationBarTitle({title:"订单"})):2==i.status&&(i.getCard(),t.setNavigationBarTitle({title:"卡券"}))):t.redirectTo({url:"/pages/user-center/user-center"})})),i.first||(1==i.status?i.getList():2==i.status&&i.getCard())},methods:{getMore:function(){var e,a,i=this;if(i.load)return!1;i.load=!0,1==i.status?3==i.activeTab?(e=i.$api.clerk.my,a={page:i.page}):5==i.activeTab?(e=i.$api.clerk.order,a={status:i.activeTab,keyword_1:8,keyword:i.keyword}):(e=i.$api.clerk.order,a={page:i.page,is_clerk:i.activeTab}):3==i.activeTab?(e=i.$api.clerk.my_card,a={page:i.page}):(e=i.$api.clerk.card,a={page:i.page,is_clerk:i.activeTab}),i.$request({url:e,data:a}).then((function(e){i.$hideLoading(),i.load=!1,0==e.code?(i.list=i.list.concat(e.data.list),i.page++,i.more_list=!1,e.data.list.length==e.data.pagination.pageSize&&(i.more_list=!0),i.list.forEach((function(t){t.refund=null,2==t.cancel_status?t.refund="申请取消中":0==t.is_pay&&(t.refund="订单未支付")}))):t.showToast({title:e.msg,icon:"none",duration:1e3})})).catch((function(t){i.load=!1,i.$hideLoading()}))},toClerk:function(e){t.navigateTo({url:"/pages/order/clerk/clerk?id="+e})},toClerkCard:function(e){t.navigateTo({url:"/pages/card/clerk/clerk?cardId="+e})},toDetail:function(e){t.navigateTo({url:"/plugins/clerk/detail/detail?id="+e})},toCardDetail:function(e){t.navigateTo({url:"/plugins/clerk/detail/detail?card_id="+e})},keywordSearch:function(t){this.keyword=t,this.searchResult=!0,1==this.status?this.getList():this.getCard()},beSearch:function(){this.candidate=t.getStorageSync("clerk_keyword"),2==this.status&&(this.candidate=t.getStorageSync("clerk_card_keyword")),this.toSearch=!this.toSearch,this.list=[],this.searchResult=!1,t.setNavigationBarTitle({title:"搜索"})},cancelSeacrch:function(){this.toSearch=!this.toSearch,this.keyword="",1==this.status?(this.getList(),t.setNavigationBarTitle({title:"订单"})):(this.getCard(),t.setNavigationBarTitle({title:"卡券"}))},search:function(){var e=t.getStorageSync("clerk_keyword");2==this.status&&(e=t.getStorageSync("clerk_card_keyword")),0!=this.keyword.length&&0!=this.keyword.trim().length?(e.length>0?e.unshift(this.keyword):e=[this.keyword],e.forEach((function(t,a){e[0]==e[a]&&a>0&&e.splice(a,1)})),1==this.status?(t.setStorage({key:"clerk_keyword",data:e}),this.getList()):(t.setStorage({key:"clerk_card_keyword",data:e}),this.getCard())):this.keyword=""},clear:function(){var e=this;t.removeStorage({key:2==this.status?"clerk_card_keyword":"clerk_keyword",success:function(a){e.candidate=[],t.showToast({title:"清理成功",duration:1e3,type:"success",mask:!1})}})},tabStatus:function(e){var a=this;if(a.load)return!1;t.showLoading({title:"加载中..."}),a.list=[],a.page=2,a.activeTab=e.currentTarget.dataset.id,1==this.status?this.getList():this.getCard()},tab:function(e){var a=this;if(a.load)return!1;t.showLoading({title:"加载中..."}),a.list=[],a.page=2,a.activeTab=2,a.status=e,1==e?(this.tabList=this.order_list,this.getList()):(this.tabList=this.card_list,this.getCard())},getList:function(){var e,a,i=this;if(i.load)return!1;i.load=!0,3==this.activeTab?(e=i.$api.clerk.my,a={keyword_1:8,keyword:this.keyword}):5==this.activeTab?(e=i.$api.clerk.order,a={status:this.activeTab,keyword_1:8,keyword:this.keyword}):(e=i.$api.clerk.order,a={is_clerk:this.activeTab,keyword_1:8,keyword:this.keyword}),i.$request({url:e,data:a}).then((function(e){t.hideLoading(),i.$hideLoading(),i.load=!1,0==e.code?(i.first=!0,i.list=e.data.list,i.page=2,i.searchResult=!0,i.more_list=!1,e.data.list.length==e.data.pagination.pageSize&&(i.more_list=!0),i.list.forEach((function(t){t.refund=null,2==t.cancel_status?t.refund="申请退款中":0==t.is_pay&&(t.refund="订单未支付")}))):t.showToast({title:e.msg,icon:"none",duration:1e3})})).catch((function(e){i.load=!1,t.hideLoading(),i.$hideLoading()}))},getCard:function(){var e,a,i=this;if(i.load)return!1;i.load=!0,3==this.activeTab?(e=i.$api.clerk.my_card,a={keyword:this.keyword}):(e=i.$api.clerk.card,a={is_clerk:this.activeTab,keyword:this.keyword}),i.$request({url:e,data:a}).then((function(e){i.load=!1,t.hideLoading(),i.$hideLoading(),0==e.code?(i.list=e.data.list,i.page=2,i.searchResult=!0,i.more_list=!1,e.data.list.length==e.data.pagination.pageSize&&(i.more_list=!0)):t.showToast({title:e.msg,icon:"none",duration:1e3})})).catch((function(e){i.load=!1,t.hideLoading(),i.$hideLoading()}))}}};e.default=c}).call(this,a("543d")["default"])}},[["bbf4","common/runtime","common/vendor"]]]);