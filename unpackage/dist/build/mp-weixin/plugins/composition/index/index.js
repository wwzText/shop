(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["plugins/composition/index/index"],{"1f19":function(t,o,e){},"4b4b":function(t,o,e){"use strict";var i;e.d(o,"b",(function(){return n})),e.d(o,"c",(function(){return a})),e.d(o,"a",(function(){return i}));var n=function(){var t=this,o=t.$createElement;t._self._c},a=[]},"518b":function(t,o,e){"use strict";(function(t){Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var i=e("2f62");function n(t,o){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);o&&(i=i.filter((function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable}))),e.push.apply(e,i)}return e}function a(t){for(var o=1;o<arguments.length;o++){var e=null!=arguments[o]?arguments[o]:{};o%2?n(Object(e),!0).forEach((function(o){s(t,o,e[o])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):n(Object(e)).forEach((function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(e,o))}))}return t}function s(t,o,e){return o in t?Object.defineProperty(t,o,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[o]=e,t}var r=function(){e.e("components/basic-component/app-composition/app-composition").then(function(){return resolve(e("1410"))}.bind(null,e)).catch(e.oe)},c={data:function(){return{about:"",list:[],detail:{},position:"static",iphone_x:!1,noMore:!1,showGoods:!1,page:2,height:0,scrollHeight:0,tabbarbool:!1,animationData:{},currentRoute:this.$platDiff.route(),activityBg:""}},components:{"app-composition":r},computed:a(a({},(0,i.mapState)({tabBarNavs:function(t){return t.mallConfig.navbar.navs},compositionImg:function(t){return t.mallConfig.__wxapp_img.composition}})),(0,i.mapGetters)("mallConfig",{getTheme:"getTheme"})),watch:{tabBarNavs:{handler:function(){this.b()},immediate:!0}},methods:{b:function(){for(var t=this.currentRoute,o=0;o<this.tabBarNavs.length;o++)if(t.includes(this.tabBarNavs[o].url.split("?")[0]))return this.tabbarbool=!0;return this.tabbarbool=!1},show:function(o){var e=this;e.detail=o,e.showGoods=!0,e.position="fixed";var i=t.createAnimation({duration:1e3,timingFunction:"ease"});e.animationData=i,setTimeout((function(){i.translateY(e.height).step(),e.animationData=i.export()}),200)},close:function(){this.detail={},this.showGoods=!1,this.position="static"},toRule:function(){t.navigateTo({url:"/pages/rules/index?url=".concat(encodeURIComponent(this.$api.composition.config),"&key=rule")})},toDetail:function(o){t.navigateTo({url:"/plugins/composition/detail/detail?composition_id="+o.id})},toGoods:function(o){t.navigateTo({url:"/pages/goods/goods?id="+o})},toSearch:function(){t.navigateTo({url:"/plugins/composition/search/search"})},getSetting:function(){var o=this;o.$showLoading({type:"global",text:"加载中..."}),o.$request({url:o.$api.composition.config}).then((function(e){0==e.code?(o.getList(),o.activityBg=e.data.activityBg):(o.$hideLoading(),t.showToast({title:e.msg,icon:"none",duration:1e3}))})).catch((function(t){o.$hideLoading()}))},getList:function(){var o=this;o.$request({url:o.$api.composition.index}).then((function(e){if(o.$hideLoading(),0==e.code){for(var i in o.list=e.data.list,o.list.length<5&&(o.noMore=!0),o.list)for(var n in o.list[i].choose=!1,o.list[i].goods_list)o.list[i].goods_list[n].choose_attr=null,2==o.list[i].type&&(o.list[i].host_list[0].choose_attr=null,o.list[i].host_list[0].opacity=1,o.list[i].goods_list[n].choose_goods=!1,o.list[i].host_list[0].choose_goods=!1);t.setStorage({key:"composition",data:o.list})}else o.$hideLoading(),t.showToast({title:e.msg,icon:"none",duration:1e3})})).catch((function(t){o.$hideLoading()}))},getMore:function(){var o=this,e=this;t.showLoading({title:"加载中"}),e.$request({url:e.$api.composition.index,data:{page:e.page}}).then((function(i){if(t.hideLoading(),0==i.code){if(0==i.data.list.length)return o.noMore=!0,!1;e.page++;var n=i.data.list;for(var a in n)for(var s in n[a].choose=!1,n[a].goods_list)n[a].goods_list[s].choose_attr=null,2==n[a].type&&(n[a].host_list[0].choose_attr=null,n[a].host_list[0].opacity=1,n[a].goods_list[s].choose_goods=!1,n[a].host_list[0].choose_goods=!1);e.list=e.list.concat(n),t.setStorage({key:"composition",data:e.list})}else t.hideLoading(),t.showToast({title:i.msg,icon:"none",duration:1e3})})).catch((function(){e.$hideLoading()}))}},onLoad:function(){var o=this;t.getSystemInfo({success:function(t){o.height=-t.screenHeight,(t.model.indexOf("iPhone X")>-1||t.model.indexOf("iPhone 11")>-1||t.model.indexOf("iPhone11")>-1||t.model.indexOf("iPhone12")>-1||t.model.indexOf("Unknown Device")>-1)&&(o.iphone_x=!0)}}),wx.showShareMenu({menus:["shareAppMessage","shareTimeline"]}),o.getSetting()},onShareAppMessage:function(){return this.$shareAppMessage({title:this.$children[0].navigationBarTitle,path:"/plugins/composition/index/index"})},onShareTimeline:function(){return this.$shareTimeline({title:this.$children[0].navigationBarTitle,query:{}})},onReachBottom:function(){this.noMore||this.getMore()}};o.default=c}).call(this,e("543d")["default"])},"5d41":function(t,o,e){"use strict";e.r(o);var i=e("518b"),n=e.n(i);for(var a in i)"default"!==a&&function(t){e.d(o,t,(function(){return i[t]}))}(a);o["default"]=n.a},"93e5":function(t,o,e){"use strict";(function(t){e("b8bc");i(e("66fd"));var o=i(e("be3a"));function i(t){return t&&t.__esModule?t:{default:t}}t(o.default)}).call(this,e("543d")["createPage"])},be3a:function(t,o,e){"use strict";e.r(o);var i=e("4b4b"),n=e("5d41");for(var a in n)"default"!==a&&function(t){e.d(o,t,(function(){return n[t]}))}(a);e("c4af");var s,r=e("f0c5"),c=Object(r["a"])(n["default"],i["b"],i["c"],!1,null,"a1e5fa74",null,!1,i["a"],s);o["default"]=c.exports},c4af:function(t,o,e){"use strict";var i=e("1f19"),n=e.n(i);n.a}},[["93e5","common/runtime","common/vendor"]]]);