{"version":3,"sources":["uni-app:///main.js","webpack:///C:/Users/26439/Desktop/shop4.3.57_1/pages/search/search.vue?c415","webpack:///C:/Users/26439/Desktop/shop4.3.57_1/pages/search/search.vue?7e29","webpack:///C:/Users/26439/Desktop/shop4.3.57_1/pages/search/search.vue?96d5","webpack:///C:/Users/26439/Desktop/shop4.3.57_1/pages/search/search.vue?4817","uni-app:///pages/search/search.vue","webpack:///C:/Users/26439/Desktop/shop4.3.57_1/pages/search/search.vue?3f8b","webpack:///C:/Users/26439/Desktop/shop4.3.57_1/pages/search/search.vue?8d83"],"names":["createPage","Page"],"mappings":";;;;;;;;;;kDAAA;AACA;AACA,iG;AACAA,UAAU,CAACC,eAAD,CAAV,C;;;;;;;;;;;;;ACHA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA+H;AAC/H;AAC0D;AACL;AACsC;;;AAG3F;AACqK;AACrK,gBAAgB,+KAAU;AAC1B,EAAE,4EAAM;AACR,EAAE,6FAAM;AACR,EAAE,sGAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,iGAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACRA;AAAA;AAAA;AAAA;AAAgmB,CAAgB,0nBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACqGpnB,gD;;;AAGA;AACA;AACA,uB;;AAEA;AACA,gBADA;AAEA;AACA,gCADA,EAFA;;AAKA,MALA,kBAKA;AACA;AACA,sBADA;AAEA,cAFA;AAGA,qBAHA;AAIA,qBAJA;AAKA,iBALA;AAMA,wBANA;AAOA,eAPA;AAQA,sBARA;AASA,kBATA;AAUA,yBAVA;AAWA,oBAXA;AAYA,uBAZA;;AAcA,GApBA;AAqBA;AACA;AACA,wBADA;AAEA,4BAFA,GADA;;AAKA,WALA,qBAKA;AACA;AACA;AACA,OAFA,MAEA;AACA;AACA;AACA,KAXA;AAYA,iBAZA,2BAYA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YADA,EACA,gBADA,EACA,wBADA,EACA,kBADA,EACA,oBADA;;AAGA,KAtBA;AAuBA;AACA;AACA,wDADA;AAEA,4BAFA;AAGA,yDAHA;AAIA,yDAJA;;AAMA,KA9BA;AA+BA;AACA,8HADA,GA/BA,CArBA;;;AAwDA,QAxDA,kBAwDA,OAxDA,EAwDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAjEA;AAkEA,eAlEA,2BAkEA;AACA;;AAEA,KAFA,MAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GA5EA;AA6EA;AACA;AACA,aADA,mBACA,CADA,EACA;AACA;AACA;AACA;AACA,OALA;AAMA,qBANA,EADA,EA7EA;;;AAuFA;AACA,aADA,uBACA;AACA,2BADA,GACA,iBADA;AAEA;AACA,sBADA,GACA,KADA;AAEA;;;;;AAKA;;AAEA;AACA,gCADA;AAEA;AACA;AACA;AACA;AACA,uBAFA,MAEA;AACA;AACA;AACA,qBATA,EASA,IATA;AAUA,mBAjBA,EAiBA,GAjBA;AAkBA,iBAtBA;AAuBA,KAxBA;AAyBA,cAzBA,sBAyBA,GAzBA,EAyBA;AACA;AACA,yCAFA;AAGA,wBAHA,CAGA,WAHA,uBAGA,WAHA,CAGA,SAHA,uBAGA,SAHA;;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAHA,MAGA;AACA;AACA;AACA,WAFA,MAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAvDA;;AAyDA,mBAzDA,2BAyDA,GAzDA,EAyDA;AACA,sBADA;AAEA,wBAFA,CAEA,QAFA,wBAEA,QAFA,CAEA,SAFA,wBAEA,SAFA,CAEA,WAFA,wBAEA,WAFA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SALA;AAMA;AACA,oBADA;;AAGA;AACA;AACA,OAfA,MAeA;AACA;AACA;AACA;AACA;AACA;AACA,KAnFA;;AAqFA,iBArFA,2BAqFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KA/FA;AAgGA,YAhGA,oBAgGA,GAhGA,EAgGA;AACA;AACA,KAlGA;AAmGA,SAnGA,mBAmGA;AACA;AACA;AACA;AACA,KAvGA;AAwGA,gBAxGA,0BAwGA;AACA;AACA;AACA;AACA;AACA,uCADA;AAEA,UAFA,CAEA;AACA;AACA,OAJA;AAKA,KAjHA;AAkHA,UAlHA,oBAkHA;AACA;AACA;AACA;AACA;AACA,KAvHA;AAwHA,SAxHA,mBAwHA;AACA;AACA;AACA;AACA;AACA,KA7HA;AA8HA,UA9HA,oBA8HA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KArIA;AAsIA,gBAtIA,0BAsIA;AACA;AACA;AACA;AACA;AACA,yCADA;AAEA;AACA,+BADA;AAEA,6BAFA;AAGA,oBAHA,EAFA;;AAOA,UAPA,CAOA;AACA;AACA;AACA,+BAHA;AAIA,YAJA,GAIA,QAJA,CAIA,IAJA,CAIA,IAJA,GAIA,QAJA,CAIA,IAJA,CAIA,GAJA,GAIA,QAJA,CAIA,GAJA;AAKA;AACA;AACA;AACA;AACA;AACA,WAHA,MAGA;AACA;AACA;AACA;AACA,SATA,MASA;AACA;AACA,wBADA;;AAGA;AACA,OA1BA,EA0BA,KA1BA,CA0BA;AACA;AACA,OA5BA;AA6BA,KAvKA;AAwKA,cAxKA,wBAwKA;AACA;AACA;;AAEA;AACA;AACA,OAFA;AAGA;AACA,wBADA;;AAGA;AACA;AACA;AACA,KArLA;AAsLA,cAtLA,wBAsLA;AACA;AACA;AACA;AACA,KA1LA;AA2LA,iBA3LA,2BA2LA;AACA;AACA;AACA,8BADA;AAEA;AACA;AACA;AACA;AACA;AACA,SAPA;;AASA,KAtMA;AAuMA,gBAvMA,wBAuMA,OAvMA,EAuMA;AACA;AACA;AACA,KA1MA;AA2MA,gBA3MA,0BA2MA;AACA;AACA;AACA;AACA,0CADA;AAEA;AACA,qBADA;AAEA,uBAFA,EAFA;;AAMA,UANA,CAMA;AACA;AACA,OARA;AASA,KAvNA,EAvFA,E;;;;;;;;;;;;;AC5GA;AAAA;AAAA;AAAA;AAA0nC,CAAgB,omCAAG,EAAC,C;;;;;;;;;;;ACA9oC;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages/search/search.js","sourcesContent":["import 'uni-pages';\nimport Vue from 'vue'\nimport Page from './pages/search/search.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./search.vue?vue&type=template&id=4cedc0c6&scoped=true&\"\nvar renderjs\nimport script from \"./search.vue?vue&type=script&lang=js&\"\nexport * from \"./search.vue?vue&type=script&lang=js&\"\nimport style0 from \"./search.vue?vue&type=style&index=0&id=4cedc0c6&scoped=true&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"4cedc0c6\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/search/search.vue\"\nexport default component.exports","export * from \"-!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--16-0!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./search.vue?vue&type=template&id=4cedc0c6&scoped=true&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./search.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./search.vue?vue&type=script&lang=js&\"","<template>\r\n    <view class=\"app-layout\" :style=\"{background: isSearch ? '#f7f7f7' : '#fafafa'}\">\r\n        <app-layout>\r\n            <view class=\"search\">\r\n                <view class=\"top\">\r\n                    <view class=\"dir-left-nowrap box\">\r\n                        <input type=\"text\" class=\"box-grow-1 input\" confirm-type=\"搜索\" @confirm=\"search\"\r\n                               v-model=\"keyword\">\r\n                        <view class=\"close-tip\" @click=\"clear\">\r\n                            <image class=\"search-close\" v-if=\"keyword\"\r\n                                   src=\"/static/image/icon/delete-yuan.png\"></image>\r\n                        </view>\r\n                        <view class=\"box-grow-0 cross-center\" @click=\"search\">搜索</view>\r\n                    </view>\r\n                </view>\r\n                <!-- hidden -->\r\n                <view style=\"height: 104rpx\"></view>\r\n                <view class=\"hot opacity-hide\">\r\n                    <view v-if=\"historyList.length > 0\" class=\"history\">\r\n                        <view class=\"dir-left-wrap list\">\r\n                            <block v-for=\"(item, index) in historyList\" :key=\"index\">\r\n                                <view class=\"box-grow-0 cross-center item once-item\">\r\n                                    <view class=\"t-omit\" style=\"max-width: 650rpx\">{{item.keyword}}</view>\r\n                                </view>\r\n                            </block>\r\n                        </view>\r\n                    </view>\r\n                </view>\r\n                <!-- -->\r\n                <view v-show=\"!isSearch\" class=\"hot\">\r\n                    <!-- 历史记录 -->\r\n                    <view v-if=\"historyList.length > 0\" class=\"history\">\r\n                        <view class=\"dir-left-nowrap cross-center title\">\r\n                            <view class=\"box-grow-1\">历史搜索</view>\r\n                            <image src=\"../../static/image/icon/delete.png\" class=\"box-grow-0\"\r\n                                   @click=\"deleteHistory\"></image>\r\n                        </view>\r\n                        <view class=\"dir-left-wrap list\">\r\n                            <view class=\"dir-top-nowrap\">\r\n                                <view v-for=\"(line, temp_index) in realHistoryList\" :key=\"temp_index\"\r\n                                      class=\"dir-left-wrap box-grow-1\">\r\n                                    <view v-for=\"(item, index) in line\" :key=\"index\" class=\"dir-left-wrap\">\r\n                                        <view v-if=\"!item.mark\" class=\"box-grow-0 cross-center item\"\r\n                                              @click=\"historyClick(item.keyword)\">\r\n                                            <view class=\"t-omit\" style=\"max-width: 650rpx\">{{item.keyword}}</view>\r\n                                        </view>\r\n                                        <view v-if=\"item.mark && temp_index === 1\"\r\n                                              class=\"box-grow-0 close-pic cross-center\"\r\n                                              @click=\"selectAllList\">\r\n                                            <image src=\"./image/icon_open.png\"></image>\r\n                                        </view>\r\n                                    </view>\r\n                                </view>\r\n                            </view>\r\n                        </view>\r\n                    </view>\r\n                    <!-- 热搜 -->\r\n                    <view class=\"hot-center\" v-if=\"getSetting.is_show_hot_goods == 1\">\r\n                        <image class=\"top-image\" src=\"./image/icon_top.png\"></image>\r\n                        <view class=\"top-list\" v-if=\"hotGoodsList && hotGoodsList.length\">\r\n                            <view v-for=\"(goods,index) in hotGoodsList\" :key=\"index\"\r\n                                  class=\"item cross-center dir-left-nowrap\"\r\n                                  @click=\"goodsNav(goods.url)\">\r\n                                <view class=\"box-grow-0 main-center first\">\r\n                                    <image v-if=\"goods.sort < 4\" :src=\"goods.sort === 1 ? './image/list_icon_first.png' :\r\n                                    goods.sort === 2 ? './image/list_icon_second.png' : './image/list_cion_third.png'\"></image>\r\n                                    <view v-if=\"goods.sort > 3\">{{goods.sort}}</view>\r\n                                </view>\r\n                                <view class=\"goods-image box-grow-0\">\r\n                                    <image :src=\"goods.cover_pic\"></image>\r\n                                </view>\r\n                                <view class=\"goods-name t-omit\">{{goods.title}}</view>\r\n                            </view>\r\n                        </view>\r\n                    </view>\r\n                </view>\r\n                <view v-if=\"isSearch\" class=\"goods-list\">\r\n                    <template v-if=\"list.length <= 0\">\r\n                        <view class=\"main-center no-result\">\r\n                            <view class=\"dir-left-nowrap cross-center\">\r\n                                <image class=\"box-grow-0 empty\" src=\"../../static/image/icon/empty.png\"></image>\r\n                                <view class=\"box-grow-1\">\r\n                                    <view>抱歉，没有相关商品</view>\r\n                                    <view v-if=\"!mch_id\" class=\"text\">以下是为您推荐的商品</view>\r\n                                </view>\r\n                            </view>\r\n                        </view>\r\n                    </template>\r\n                    <view style=\"background-color: #f7f7f7\">\r\n                        <u-ordinary-list :is-under-line-price=\"isListUnderlinePrice == 1 ? true : false\"\r\n                                         :theme-object=\"themeObject\" :reset=\"goodsReset\" :pagination=\"true\" :isShowAttr=\"true\" :list=\"newList\" :theme=\"getTheme\"\r\n                                         :list-style=\"2\"></u-ordinary-list>\r\n                    </view>\r\n                </view>\r\n                <view class=\"u-loading-list\" v-if=\"loading\">加载中...</view>\r\n            </view>\r\n        </app-layout>\r\n    </view>\r\n</template>\r\n\r\n<script>\r\nimport {mapGetters, mapState} from 'vuex';\r\nimport uOrdinaryList from '../../components/page-component/u-goods-list/u-ordinary-list.vue';\r\n\r\nlet page = 1;\r\nlet is_loading = false;\r\nlet is_no_more = false;\r\n\r\nexport default {\r\n    name: \"search\",\r\n    components: {\r\n        uOrdinaryList\r\n    },\r\n    data() {\r\n        return {\r\n            hotGoodsList: [],\r\n            list: [],\r\n            isSearch: false,\r\n            historyList: [],\r\n            keyword: '',\r\n            recommend_list: [],\r\n            mch_id: 0,\r\n            beginAfter: true,\r\n            tempList: [],\r\n            realHistoryList: [],\r\n            loading: false,\r\n            goodsReset: false\r\n        };\r\n    },\r\n    computed: {\r\n        ...mapGetters('mallConfig', {\r\n            getTheme: 'getTheme',\r\n            getSetting: 'getSetting',\r\n        }),\r\n        newList() {\r\n            if (this.list.length > 0) {\r\n                return this.list;\r\n            } else {\r\n                return this.recommend_list;\r\n            }\r\n        },\r\n        sizeTransform() {\r\n            const windowWidth = uni.getSystemInfoSync().windowWidth;\r\n            const p = 750 / windowWidth;\r\n            const boxLeft = 24 / p;\r\n            const marginRight = 20 / p;\r\n            const btnWidth = 60 / p;\r\n            const listWidth = windowWidth - boxLeft * 2;\r\n            return {\r\n                p, boxLeft, marginRight, btnWidth, listWidth\r\n            }\r\n        },\r\n        themeObject:function() {\r\n            return {\r\n                back: this.getTheme + '-m-back ' + this.getTheme,\r\n                theme: this.getTheme,\r\n                color: this.getTheme + '-m-text ' + this.getTheme,\r\n                sBack: this.getTheme + '-s-back ' + this.getTheme\r\n            }\r\n        },\r\n        ...mapState({\r\n            isListUnderlinePrice: state => state.mallConfig.mall.setting.is_list_underline_price\r\n        }),\r\n    },\r\n    onLoad(options) {\r\n        this.mch_id = options.mch_id ? options.mch_id : 0;\r\n        page = 1;\r\n        is_loading = false;\r\n        is_no_more = false;\r\n        this.historyList = this.getHistory();\r\n        this.getSelect();\r\n        this.getRecommend();\r\n        this.getHotSearch();\r\n    },\r\n    onReachBottom() {\r\n        if (is_no_more) {\r\n\r\n        } else {\r\n            this.goodsReset = false;\r\n            if (this.keyword) {\r\n                this.loading = true;\r\n                this.getGoodsList();\r\n            }\r\n        }\r\n    },\r\n    watch: {\r\n        keyword: {\r\n            handler(v) {\r\n                if (v == '') {\r\n                    this.cancel();\r\n                }\r\n            },\r\n            immediate: true,\r\n        }\r\n    },\r\n    methods: {\r\n        async getSelect() {\r\n            const historyList = this.historyList;\r\n            if (historyList && historyList.length) {\r\n                const self = this;\r\n                setTimeout(() => {\r\n                    // #ifndef MP-WEIXIN\r\n                    let query = uni.createSelectorQuery();\r\n                    // #endif\r\n                    // #ifdef MP-WEIXIN\r\n                    let query = uni.createSelectorQuery().in(this);\r\n                    // #endif\r\n                    query.selectAll('.once-item').fields({\r\n                        size: true,\r\n                    }, function (res) {\r\n                        self.formatData(res);\r\n                        if (self.beginAfter) {\r\n                            self.selectLimitList(res);\r\n                        } else {\r\n                            self.selectAllList();\r\n                        }\r\n                    }).exec();\r\n                },500)\r\n            }\r\n        },\r\n        formatData(res) {\r\n            const self = this;\r\n            const historyList = self.historyList;\r\n            const {marginRight, listWidth} = self.sizeTransform;\r\n\r\n            //列表格式化\r\n            let tempList = [];\r\n            let item = [];\r\n            let line_width = 0;\r\n            for (let i = 0; i < res.length; i++) {\r\n                const alone_width = res[i].width + marginRight;\r\n                let alone_width_count = alone_width + line_width;\r\n                if (alone_width_count <= listWidth) {\r\n                    item.push(historyList[i]);\r\n                    line_width = alone_width_count;\r\n                } else {\r\n                    if (item.length === 0 && line_width === 0) {\r\n                        tempList.push([historyList[i]]);\r\n                    } else {\r\n                        tempList.push(item);\r\n                        line_width = 0;\r\n                        item = [];\r\n                        i--;\r\n                    }\r\n                }\r\n            }\r\n            if (item.length) {\r\n                tempList.push(item);\r\n            }\r\n            this.tempList = tempList;\r\n        },\r\n\r\n        selectLimitList(res) {\r\n            const self = this;\r\n            const {btnWidth, listWidth, marginRight} = self.sizeTransform;\r\n            let newArr = JSON.parse(JSON.stringify(self.tempList));\r\n            let realHistoryList = [];\r\n            if (newArr.length > 2) {\r\n                let indexMore = 0;\r\n                const secondWidth = listWidth - btnWidth - marginRight;\r\n                let maxWidth = 0;\r\n                newArr[1].forEach((item, index) => {\r\n                    maxWidth += res[newArr[0].length + index].width + marginRight\r\n                    if (maxWidth <= secondWidth) {\r\n                        indexMore = index + 1;\r\n                    }\r\n                })\r\n                newArr[1].splice(indexMore, newArr[1].length - indexMore, {\r\n                    mark: true,\r\n                });\r\n                realHistoryList = [newArr[0], newArr[1]];\r\n                self.beginAfter = true;\r\n            } else {\r\n                //newArr.forEach(item => realHistoryList = [...realHistoryList, ...item]);\r\n                newArr.forEach(item => realHistoryList.push(item));\r\n                self.beginAfter = false;\r\n            }\r\n            self.realHistoryList = realHistoryList;\r\n        },\r\n\r\n        selectAllList() {\r\n            const tempList = this.tempList;\r\n            let arr = [];\r\n            if (tempList && tempList.length) {\r\n                for (let i = 0; i < 5 && i < tempList.length; i++) {\r\n                    arr.push(tempList[i]);\r\n                }\r\n            }\r\n            this.beginAfter = false;\r\n            this.realHistoryList = arr;\r\n        },\r\n        goodsNav(url) {\r\n            uni.navigateTo({url: url});\r\n        },\r\n        clear() {\r\n            uni.hideKeyboard()\r\n            this.keyword = '';\r\n            this.loading = false;\r\n        },\r\n        getHotSearch() {\r\n            if (this.getSetting.is_show_hot_goods != 1) {\r\n                return;\r\n            }\r\n            this.$request({\r\n                url: this.$api.goods.hot_search,\r\n            }).then(response => {\r\n                this.hotGoodsList = response.data.list;\r\n            });\r\n        },\r\n        cancel() {\r\n            this.isSearch = false;\r\n            this.loading = false;\r\n            this.keyword = '';\r\n            this.list = [];\r\n        },\r\n        reset() {\r\n            page = 1;\r\n            is_no_more = false;\r\n            this.goodsReset = true;\r\n            this.getGoodsList();\r\n        },\r\n        search() {\r\n            let keyword = this.keyword;\r\n            if (keyword === '') return;\r\n            this.keyword = keyword.trim();\r\n            this.setHistory();\r\n            this.getSelect();\r\n            this.reset();\r\n        },\r\n        getGoodsList() {\r\n            if (!this.keyword) return;\r\n            if (is_loading) return;\r\n            is_loading = true;\r\n            this.$request({\r\n                url: this.$api.default.goods_list,\r\n                data: {\r\n                    keyword: this.keyword,\r\n                    mch_id: this.mch_id,\r\n                    page: page,\r\n                }\r\n            }).then(response => {\r\n                is_loading = false;\r\n                this.isSearch = true;\r\n                this.loading = false;\r\n                let { code, data, msg } = response;\r\n                if (code === 0) {\r\n                    if (page === 1) this.list = [];\r\n                    if (data.list.length > 0) {\r\n                        this.list.push(...data.list);\r\n                        page++;\r\n                    } else {\r\n                        is_no_more = true;\r\n                        if (page === 1) this.getRecommend();\r\n                    }\r\n                } else {\r\n                    uni.showModal({\r\n                        content: msg\r\n                    })\r\n                }\r\n            }).catch(() => {\r\n                is_loading = false;\r\n            });\r\n        },\r\n        setHistory() {\r\n            let historyList = this.getHistory();\r\n            let keyword = this.keyword.trim();\r\n\r\n            historyList.forEach((item, index) => {\r\n                if (item.keyword === keyword) historyList.splice(index, 1);\r\n            });\r\n            historyList.unshift({\r\n                keyword: keyword,\r\n            });\r\n            if (historyList.length > 20) historyList.pop();\r\n            this.historyList = historyList;\r\n            uni.setStorageSync(\"SEARCH_HISTORY_LIST\", historyList);\r\n        },\r\n        getHistory() {\r\n            let historyList = uni.getStorageSync('SEARCH_HISTORY_LIST');\r\n            if (!historyList) historyList = [];\r\n            return historyList;\r\n        },\r\n        deleteHistory() {\r\n            let self = this;\r\n            uni.showModal({\r\n                content: '确认删除全部历史记录？',\r\n                success: function (res) {\r\n                    if (res.confirm) {\r\n                        uni.removeStorageSync(\"SEARCH_HISTORY_LIST\");\r\n                        self.historyList = [];\r\n                    }\r\n                }\r\n            });\r\n        },\r\n        historyClick(keyword) {\r\n            this.keyword = keyword.trim();\r\n            this.reset();\r\n        },\r\n        getRecommend() {\r\n            if (this.mch_id) return;\r\n            if (this.recommend_list.length > 0) return;\r\n            this.$request({\r\n                url: this.$api.goods.new_recommend,\r\n                data: {\r\n                    goods_id: 0,\r\n                    type: 'goods'\r\n                }\r\n            }).then(response => {\r\n                if (response.code === 0) this.recommend_list = response.data.list;\r\n            });\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n    .opacity-hide {\r\n        position: fixed;\r\n        top: var(--window-top);\r\n        z-index: -10;\r\n        opacity: 0;\r\n        overflow: hidden;\r\n    }\r\n\r\n    .search {\r\n        background-color: #efeff4;\r\n    }\r\n\r\n    .close-pic {\r\n        margin-right: #{20rpx};\r\n        margin-bottom: #{16rpx};\r\n        border-radius: 50%;\r\n\r\n        image {\r\n            height: #{60rpx};\r\n            width: #{60rpx};\r\n            display: block;\r\n        }\r\n    }\r\n\r\n    .hot {\r\n        background-color: #fafafa;\r\n        border-radius: #{16rpx};\r\n\r\n        .hot-center {\r\n            padding: #{32rpx} #{24rpx};\r\n\r\n            .top-image {\r\n                width: #{159rpx};\r\n                height: #{25rpx};\r\n                display: block;\r\n            }\r\n\r\n            .top-list {\r\n                margin-top: #{32rpx};\r\n                border-radius: #{16rpx};\r\n                padding: #{32rpx - 10rpx} 0;\r\n                box-shadow: 0 0 #{12rpx} 0 #e0e0e0;\r\n\r\n                .item {\r\n                    height: #{110rpx};\r\n\r\n                    .first {\r\n                        width: #{120rpx};\r\n                        font-weight: bold;\r\n\r\n                        image {\r\n                            width: #{48rpx};\r\n                            height: #{43rpx};\r\n                            display: block;\r\n                        }\r\n\r\n                        view {\r\n                            color: #999999;\r\n                            font-size: #{26rpx};\r\n                        }\r\n                    }\r\n\r\n                    .goods-image {\r\n                        image {\r\n                            height: #{90rpx};\r\n                            width: #{90rpx};\r\n                            display: block;\r\n                            border-radius: #{8rpx};\r\n                        }\r\n                    }\r\n\r\n                    .goods-name {\r\n                        color: #333333;\r\n                        font-size: #{26rpx};\r\n                        margin: 0 #{24rpx};\r\n                    }\r\n                }\r\n\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n    .app-layout {\r\n        min-height: 100vh;\r\n    }\r\n\r\n    .top {\r\n        position: fixed;\r\n        width: 100%;\r\n        top: var(--window-top);\r\n        z-index: 15;\r\n        padding: #{20rpx} #{24rpx};\r\n        background-color: #efeff4;\r\n        font-size: $uni-font-size-import-two;\r\n        color: $uni-general-color-one;\r\n\r\n        .input {\r\n            background-color: #ffffff;\r\n            border-radius: #{50rpx 0 0 50rpx};\r\n            padding: 0 #{32rpx};\r\n            font-size: $uni-font-size-general-one;\r\n            height: #{64rpx};\r\n        }\r\n\r\n        .box {\r\n            position: relative;\r\n\r\n            .close-tip {\r\n                width: #{64rpx};\r\n                height: #{64rpx};\r\n                background-color: #ffffff;\r\n                border-radius: #{0 50rpx 50rpx 0};\r\n                margin-right: #{20rpx};\r\n            }\r\n\r\n            .search-close {\r\n                width: #{32rpx};\r\n                height: #{32rpx};\r\n                border-radius: 50%;\r\n                margin: #{16rpx};\r\n            }\r\n        }\r\n\r\n        .radio {\r\n            margin-top: #{32rpx};\r\n\r\n            .radio-item {\r\n                padding-bottom: #{12rpx};\r\n            }\r\n\r\n            .active {\r\n                border-bottom: #{4rpx} solid;\r\n            }\r\n        }\r\n    }\r\n\r\n    .history {\r\n        padding: #{36rpx} #{24rpx};\r\n        border-radius: #{16rpx} #{16rpx} 0 0;\r\n        background-color: #ffffff;\r\n        font-size: $uni-font-size-general-one;\r\n\r\n        .title {\r\n            padding-bottom: #{24rpx};\r\n            color: $uni-general-color-one;\r\n\r\n            image {\r\n                width: #{28rpx};\r\n                height: #{34rpx};\r\n                display: block;\r\n            }\r\n        }\r\n\r\n        .list {\r\n            .item {\r\n                height: #{64rpx};\r\n                background-color: #f7f7f7;\r\n                padding: 0 #{20rpx};\r\n                margin-right: #{20rpx};\r\n                margin-bottom: #{16rpx};\r\n                border-radius: #{32rpx};\r\n            }\r\n        }\r\n    }\r\n\r\n    .goods-list {\r\n        .no-result {\r\n            height: #{156rpx};\r\n            padding: #{28rpx} 0;\r\n            font-size: $uni-font-size-general-one;\r\n            background-color: #ffffff;\r\n\r\n            .text {\r\n                color: $uni-general-color-two;\r\n            }\r\n\r\n            .empty {\r\n                width: #{100rpx};\r\n                height: #{100rpx};\r\n                display: block;\r\n                margin-right: #{40rpx};\r\n            }\r\n        }\r\n    }\r\n    .u-loading-list {\r\n        height: 64upx;\r\n        line-height: 64upx;\r\n        text-align: center;\r\n        color: #b0b0b0;\r\n        font-size: 24upx;\r\n        background-color: #f7f7f7;\r\n    }\r\n</style>\r\n","import mod from \"-!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-1!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-2!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\sass-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-4!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./search.vue?vue&type=style&index=0&id=4cedc0c6&scoped=true&lang=scss&\"; export default mod; export * from \"-!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-1!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-2!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\sass-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-4!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./search.vue?vue&type=style&index=0&id=4cedc0c6&scoped=true&lang=scss&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1608184837301\n      var cssReload = require(\"D:/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}